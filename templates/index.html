{% extends "base.html" %}

{% block title %}AIåŠ©æ‰‹é€‰æ‹© - æ™ºèƒ½AIå·¥å…·å¹³å°{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50">
    <!-- å¤´éƒ¨æ¨ªå¹… -->
    <div class="relative overflow-hidden bg-white">
        <div class="max-w-7xl mx-auto">
            <div class="relative z-10 pb-8 bg-white sm:pb-16 md:pb-20 lg:w-full lg:pb-28 xl:pb-32">
                <div class="mt-10 mx-auto max-w-7xl px-4 sm:mt-12 sm:px-6 md:mt-16 lg:mt-20 lg:px-8 xl:mt-28">
                    <div class="text-center">
                        <h1 class="text-4xl tracking-tight font-extrabold text-gray-900 sm:text-5xl md:text-6xl">
                            <span class="block xl:inline">æ™ºèƒ½AI</span>
                            <span class="block text-indigo-600 xl:inline">å·¥å…·å¹³å°</span>
                        </h1>
                        <p class="mt-3 max-w-md mx-auto text-base text-gray-500 sm:text-lg md:mt-5 md:text-xl md:max-w-3xl">
                            é€‰æ‹©ä¸“ä¸šçš„AIåŠ©æ‰‹ï¼Œè®©å·¥ä½œå­¦ä¹ æ›´é«˜æ•ˆã€‚æ”¯æŒå¤šè½®å¯¹è¯ã€ä¸ªäººè®°å¿†ã€æ™ºèƒ½å·¥å…·è°ƒç”¨ã€‚
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- åŠ©æ‰‹é€‰æ‹©åŒºåŸŸ -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <div class="text-center mb-12">
            <h2 class="text-3xl font-extrabold text-gray-900 mb-4">é€‰æ‹©æ‚¨çš„AIåŠ©æ‰‹</h2>
            <p class="text-lg text-gray-600">æ¯ä¸ªåŠ©æ‰‹éƒ½æœ‰ä¸“ä¸šçš„æŠ€èƒ½å’Œè®°å¿†èƒ½åŠ›ï¼Œä¸ºæ‚¨æä¾›ä¸ªæ€§åŒ–æœåŠ¡</p>
        </div>

        <!-- åŠ©æ‰‹å¡ç‰‡ç½‘æ ¼ -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-16">
            {% for assistant_id, name, description, icon in assistants %}
            <div class="assistant-card bg-white rounded-2xl shadow-xl cursor-pointer border border-gray-100 overflow-hidden group" onclick="selectAssistant('{{ assistant_id }}')">
                <div class="relative p-8 h-full">
                    <!-- èƒŒæ™¯è£…é¥° -->
                    <div class="absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-indigo-100 to-purple-100 rounded-full -translate-y-16 translate-x-16 group-hover:scale-110 transition-transform duration-500"></div>
                    
                    <!-- åŠ©æ‰‹å¤´åƒ -->
                    <div class="relative z-10 flex items-center justify-center w-20 h-20 mx-auto mb-6 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl shadow-lg group-hover:scale-110 group-hover:rotate-6 transition-all duration-300">
                        <span class="text-4xl">{{ icon }}</span>
                    </div>
                    
                    <!-- åŠ©æ‰‹ä¿¡æ¯ -->
                    <div class="relative z-10 text-center">
                        <h3 class="text-xl font-bold text-gray-900 mb-3 group-hover:text-indigo-600 transition-colors duration-300">{{ name }}</h3>
                        <p class="text-gray-600 text-sm leading-relaxed mb-6 h-12 overflow-hidden">{{ description[:60] }}...</p>
                        
                        <!-- åŠŸèƒ½ç‰¹æ€§ -->
                        <div class="flex flex-wrap justify-center gap-2 mb-6">
                            <span class="px-3 py-1 bg-indigo-100 text-indigo-700 rounded-full text-xs font-medium">æ™ºèƒ½åˆ†æ</span>
                            <span class="px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-xs font-medium">è®°å¿†èƒ½åŠ›</span>
                            <span class="px-3 py-1 bg-pink-100 text-pink-700 rounded-full text-xs font-medium">ä¸“ä¸šæœåŠ¡</span>
                        </div>
                        
                        <!-- å¼€å§‹æŒ‰é’® -->
                        <button class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white py-3 px-6 rounded-xl font-semibold shadow-lg group-hover:shadow-xl transform group-hover:-translate-y-1 transition-all duration-300">
                            <i class="fas fa-comments mr-2"></i>
                            å¼€å§‹å¯¹è¯
                        </button>
                    </div>
                    
                    <!-- æ‚¬åœæ•ˆæœ -->
                    <div class="absolute inset-0 bg-gradient-to-br from-indigo-600/0 to-purple-600/0 group-hover:from-indigo-600/5 group-hover:to-purple-600/5 transition-all duration-300 rounded-2xl"></div>
                </div>
            </div>
            {% endfor %}
        </div>

        <!-- AIæ¸¸æˆå¨±ä¹æ¨¡å— -->
        {% if games %}
        <div class="mb-16">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-extrabold text-gray-900 mb-4">ğŸ® AIäº’åŠ¨æ¸¸æˆ</h2>
                <p class="text-lg text-gray-600">ä½“éªŒå…¨æ–°çš„AIé©±åŠ¨æ¸¸æˆï¼ŒæŒ‘æˆ˜æ‚¨çš„æ¨ç†èƒ½åŠ›å’Œç­–ç•¥æ€ç»´</p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                {% for game_id, name, description, icon in games %}
                {% if game_id == 'ai_script_host' %}
                <!-- AIå‰§æœ¬æ€ä¸»æŒäºº - æš—çº¢å¤å¤é£æ ¼ -->
                <div class="bg-gradient-to-br from-red-900 to-orange-800 rounded-xl shadow-2xl card-hover cursor-pointer border border-red-700 relative overflow-hidden group">
                    <!-- å¤å¤çº¹ç†èƒŒæ™¯ -->
                    <div class="absolute inset-0 bg-gradient-to-br from-amber-900/20 to-red-900/30"></div>
                    <div class="absolute top-0 right-0 w-32 h-32 bg-gradient-to-bl from-yellow-600/20 to-transparent rounded-full transform translate-x-12 -translate-y-12"></div>
                    
                    <div class="p-6 relative">
                        <div class="flex items-center justify-center w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-red-700 to-orange-600 rounded-full shadow-lg border-2 border-yellow-600/30">
                            <span class="text-3xl">{{ icon }}</span>
                        </div>
                        <h3 class="text-xl font-bold text-amber-100 text-center mb-3">{{ name }}</h3>
                        <p class="text-amber-200/90 text-center text-sm leading-relaxed mb-6 min-h-[60px]">{{ description }}</p>
                        
                        <div class="flex justify-center">
                            <button onclick="selectGame('ai_script_host')" class="bg-gradient-to-r from-red-700 to-orange-600 hover:from-red-800 hover:to-orange-700 text-amber-100 px-6 py-3 rounded-lg text-sm font-bold transform hover:scale-105 transition-all duration-200 border border-yellow-600/30">
                                å¼€å§‹ä½“éªŒ
                            </button>
                        </div>
                    </div>
                    
                    <!-- è£…é¥°ç«å…‰æ•ˆæœ -->
                    <div class="absolute bottom-2 left-2 w-2 h-2 bg-yellow-400 rounded-full animate-pulse"></div>
                    <div class="absolute bottom-4 right-4 w-1 h-1 bg-orange-400 rounded-full animate-pulse" style="animation-delay: 0.5s;"></div>
                </div>
                
                {% elif game_id == 'ai_detective_game' %}
                <!-- AIæ¨ç†ä¾¦æ¢æ¸¸æˆ - ç°è“è­¦æ¢é£æ ¼ -->
                <div class="bg-gradient-to-br from-slate-600 to-blue-700 rounded-xl shadow-2xl card-hover cursor-pointer border border-slate-500 relative overflow-hidden group">
                    <!-- è­¦å¾½å›¾æ¡ˆèƒŒæ™¯ -->
                    <div class="absolute inset-0 bg-gradient-to-br from-blue-900/20 to-slate-800/30"></div>
                    <div class="absolute top-2 right-2 w-24 h-24 border-2 border-blue-300/20 rounded-full"></div>
                    <div class="absolute top-4 right-4 w-16 h-16 border border-blue-300/30 rounded-full"></div>
                    
                    <div class="p-6 relative">
                        <div class="flex items-center justify-center w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-slate-600 to-blue-600 rounded-full shadow-lg border-2 border-blue-300/30">
                            <span class="text-3xl">{{ icon }}</span>
                        </div>
                        <h3 class="text-xl font-bold text-blue-100 text-center mb-3">{{ name }}</h3>
                        <p class="text-blue-200/90 text-center text-sm leading-relaxed mb-6 min-h-[60px]">{{ description }}</p>
                        
                        <div class="flex justify-center">
                            <button onclick="selectGame('ai_detective_game')" class="bg-gradient-to-r from-slate-600 to-blue-600 hover:from-slate-700 hover:to-blue-700 text-blue-100 px-6 py-3 rounded-lg text-sm font-bold transform hover:scale-105 transition-all duration-200 border border-blue-300/30">
                                å¼€å§‹ä½“éªŒ
                            </button>
                        </div>
                    </div>
                    
                    <!-- è£…é¥°å…ƒç´  -->
                    <div class="absolute bottom-3 left-3 w-3 h-0.5 bg-blue-300/60 transform rotate-45"></div>
                    <div class="absolute bottom-2 left-5 w-2 h-0.5 bg-blue-300/60 transform -rotate-45"></div>
                </div>
                
                {% elif game_id == 'ai_werewolf_judge' %}
                <!-- AIç‹¼äººæ€æ³•å®˜ - ç‹¼äººæœˆå¤œé£æ ¼ -->
                <div class="bg-gradient-to-br from-gray-900 to-red-900 rounded-xl shadow-2xl card-hover cursor-pointer border border-red-800 relative overflow-hidden group">
                    <!-- æœˆå¤œæ•ˆæœèƒŒæ™¯ -->
                    <div class="absolute inset-0 bg-gradient-to-br from-purple-900/20 to-gray-900/40"></div>
                    <div class="absolute top-4 right-6 w-12 h-12 bg-yellow-200/80 rounded-full shadow-lg"></div>
                    <div class="absolute top-6 right-8 w-8 h-8 bg-yellow-100/60 rounded-full"></div>
                    
                    <div class="p-6 relative">
                        <div class="flex items-center justify-center w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-gray-700 to-red-700 rounded-full shadow-lg border-2 border-red-600/40">
                            <span class="text-3xl">{{ icon }}</span>
                        </div>
                        <h3 class="text-xl font-bold text-red-100 text-center mb-3">{{ name }}</h3>
                        <p class="text-red-200/90 text-center text-sm leading-relaxed mb-6 min-h-[60px]">{{ description }}</p>
                        
                        <div class="flex justify-center">
                            <button onclick="selectGame('ai_werewolf_judge')" class="bg-gradient-to-r from-gray-700 to-red-700 hover:from-gray-800 hover:to-red-800 text-red-100 px-6 py-3 rounded-lg text-sm font-bold transform hover:scale-105 transition-all duration-200 border border-red-600/40">
                                å¼€å§‹ä½“éªŒ
                            </button>
                        </div>
                    </div>
                    
                    <!-- è£…é¥°æ˜Ÿæ˜Ÿæ•ˆæœ -->
                    <div class="absolute top-8 left-4 w-1 h-1 bg-yellow-300 rounded-full animate-pulse"></div>
                    <div class="absolute top-12 left-8 w-0.5 h-0.5 bg-yellow-400 rounded-full animate-pulse" style="animation-delay: 1s;"></div>
                    <div class="absolute bottom-8 left-6 w-1 h-1 bg-yellow-200 rounded-full animate-pulse" style="animation-delay: 2s;"></div>
                </div>
                {% endif %}
                {% endfor %}
            </div>
            
            <!-- æ¸¸æˆç‰¹è‰²è¯´æ˜ -->
            <div class="mt-12 grid grid-cols-1 md:grid-cols-3 gap-6 text-center">
                <div class="p-4">
                    <div class="w-12 h-12 mx-auto mb-3 bg-red-100 rounded-full flex items-center justify-center">
                        <span class="text-2xl">ğŸ­</span>
                    </div>
                    <h4 class="font-semibold text-gray-900 mb-2">æ²‰æµ¸å¼å‰§æœ¬æ€</h4>
                    <p class="text-sm text-gray-600">AIç”Ÿæˆå¤æ‚æ¡ˆä»¶ï¼Œæ‰®æ¼”å¤šä¸ªè§’è‰²ï¼Œæä¾›ç”µå½±çº§æ¨ç†ä½“éªŒ</p>
                </div>
                <div class="p-4">
                    <div class="w-12 h-12 mx-auto mb-3 bg-blue-100 rounded-full flex items-center justify-center">
                        <span class="text-2xl">ğŸ”</span>
                    </div>
                    <h4 class="font-semibold text-gray-900 mb-2">ç§‘å­¦æ¨ç†è®­ç»ƒ</h4>
                    <p class="text-sm text-gray-600">ä¸“ä¸šæ¡ˆä»¶è®¾è®¡ï¼ŒåŸ¹å…»é€»è¾‘æ€ç»´å’Œè§‚å¯Ÿèƒ½åŠ›</p>
                </div>
                <div class="p-4">
                    <div class="w-12 h-12 mx-auto mb-3 bg-gray-100 rounded-full flex items-center justify-center">
                        <span class="text-2xl">ğŸº</span>
                    </div>
                    <h4 class="font-semibold text-gray-900 mb-2">ç­–ç•¥åšå¼ˆå¯¹æˆ˜</h4>
                    <p class="text-sm text-gray-600">ä¸AIç©å®¶æ–—æ™ºæ–—å‹‡ï¼Œä½“éªŒå¿ƒç†æˆ˜æœ¯çš„é­…åŠ›</p>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- æœ€è¿‘å¯¹è¯ -->
        {% if recent_conversations %}
        <div class="bg-white rounded-xl shadow-lg p-6">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-semibold text-gray-900 flex items-center">
                    <svg class="w-5 h-5 mr-2 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                    æœ€è¿‘å¯¹è¯
                </h3>
                <span class="text-sm text-gray-500">{{ recent_conversations|length }} ä¸ªå¯¹è¯</span>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                {% for conversation in recent_conversations %}
                <div class="group relative border border-gray-200 rounded-xl p-4 hover:border-indigo-300 hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1">
                    <!-- åŠ©æ‰‹å›¾æ ‡å’Œä¿¡æ¯ -->
                    <div class="flex items-start space-x-3 mb-3">
                        <div class="w-10 h-10 gradient-bg rounded-full flex items-center justify-center flex-shrink-0">
                            {% for assistant_id, name, description, icon in assistants %}
                                {% if assistant_id == conversation.assistant_type %}
                                    <span class="text-lg">{{ icon }}</span>
                                {% endif %}
                            {% endfor %}
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="flex items-center justify-between">
                                <span class="text-sm font-semibold text-indigo-600 truncate">
                                    {% for assistant_id, name, description, icon in assistants %}
                                        {% if assistant_id == conversation.assistant_type %}{{ name }}{% endif %}
                                    {% endfor %}
                                </span>
                                <span class="text-xs text-gray-400 ml-2" title="{{ conversation.updated_at }}">{{ conversation.updated_at[:10] }}</span>
                            </div>
                            {% if conversation.title %}
                            <p class="text-sm text-gray-900 font-medium mt-1 line-clamp-2">{{ conversation.title }}</p>
                            {% else %}
                            <p class="text-xs text-gray-500 mt-1">ä¼šè¯ {{ conversation.session_id[:8] }}...</p>
                            {% endif %}
                        </div>
                    </div>
                    
                    <!-- æ“ä½œæŒ‰é’® -->
                    <div class="flex items-center justify-between mt-4">
                        <button onclick="continueConversation('{{ conversation.session_id }}', '{{ conversation.assistant_type }}')"
                                class="flex-1 bg-indigo-50 hover:bg-indigo-100 text-indigo-700 text-sm font-medium py-2 px-3 rounded-lg transition-colors mr-2">
                            <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                            </svg>
                            ç»§ç»­å¯¹è¯
                        </button>
                        <button onclick="deleteConversation('{{ conversation.session_id }}', event)"
                                class="flex-shrink-0 w-9 h-9 bg-red-50 hover:bg-red-100 text-red-600 rounded-lg transition-colors flex items-center justify-center group"
                                title="åˆ é™¤å¯¹è¯">
                            <svg class="w-4 h-4 group-hover:scale-110 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                            </svg>
                        </button>
                    </div>
                    
                    <!-- æ‚¬åœæ•ˆæœ -->
                    <div class="absolute inset-0 bg-gradient-to-r from-indigo-500/5 to-purple-500/5 rounded-xl opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none"></div>
                </div>
                {% endfor %}
            </div>
            
            <!-- å¦‚æœå¯¹è¯å¾ˆå¤šï¼Œæ·»åŠ æŸ¥çœ‹æ›´å¤šæŒ‰é’® -->
            {% if recent_conversations|length >= 6 %}
            <div class="text-center mt-6">
                <button class="text-indigo-600 hover:text-indigo-800 text-sm font-medium transition-colors">
                    æŸ¥çœ‹æ›´å¤šå¯¹è¯ â†’
                </button>
            </div>
            {% endif %}
        </div>
        {% endif %}

        <!-- åŠŸèƒ½ç‰¹è‰² -->
        <div class="mt-16 grid grid-cols-1 md:grid-cols-3 gap-8">
            <div class="text-center">
                <div class="flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-indigo-100 rounded-full">
                    <svg class="w-6 h-6 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                    </svg>
                </div>
                <h3 class="text-lg font-semibold text-gray-900 mb-2">å¤šè½®å¯¹è¯</h3>
                <p class="text-gray-600">æ”¯æŒè¿ç»­å¯¹è¯ï¼ŒAIè®°ä½ä¸Šä¸‹æ–‡ï¼Œæä¾›æ›´å‡†ç¡®çš„å»ºè®®</p>
            </div>
            
            <div class="text-center">
                <div class="flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-purple-100 rounded-full">
                    <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                    </svg>
                </div>
                <h3 class="text-lg font-semibold text-gray-900 mb-2">ä¸ªäººè®°å¿†</h3>
                <p class="text-gray-600">è®°ä½æ‚¨çš„åå¥½ã€ç›®æ ‡å’Œè¿›åº¦ï¼Œæä¾›ä¸ªæ€§åŒ–æœåŠ¡</p>
            </div>
            
            <div class="text-center">
                <div class="flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-green-100 rounded-full">
                    <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.031 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                    </svg>
                </div>
                <h3 class="text-lg font-semibold text-gray-900 mb-2">å®‰å…¨é˜²æŠ¤</h3>
                <p class="text-gray-600">å…ˆè¿›çš„æç¤ºè¯æ³¨å…¥é˜²æŠ¤ï¼Œç¡®ä¿å¯¹è¯å®‰å…¨å¯é </p>
            </div>
        </div>
    </div>
</div>

<!-- åŠ©æ‰‹ä»‹ç»æ¨¡æ€æ¡† -->
<div id="assistant-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden z-50">
    <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
        <div class="fixed inset-0 transition-opacity" aria-hidden="true">
            <div class="absolute inset-0 bg-gray-500 opacity-75"></div>
        </div>
        
        <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
            <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                <div class="sm:flex sm:items-start">
                    <div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-indigo-100 sm:mx-0 sm:h-10 sm:w-10">
                        <span id="modal-icon" class="text-2xl"></span>
                    </div>
                    <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left">
                        <h3 class="text-lg leading-6 font-medium text-gray-900" id="modal-title"></h3>
                        <div class="mt-2">
                            <p class="text-sm text-gray-500" id="modal-description"></p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                <button type="button" id="start-chat-btn"
                        class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-indigo-600 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:ml-3 sm:w-auto sm:text-sm">
                    å¼€å§‹å¯¹è¯
                </button>
                <button type="button" onclick="closeModal()"
                        class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm">
                    å–æ¶ˆ
                </button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
    let selectedAssistant = null;
    
    // åŠ©æ‰‹æ•°æ®
    const assistants = {
        {% for assistant_id, name, description, icon in assistants %}
        '{{ assistant_id }}': {
            name: '{{ name }}',
            description: '{{ description }}',
            icon: '{{ icon }}'
        }{% if not loop.last %},{% endif %}
        {% endfor %}
    };
    
    function selectAssistant(assistantId, assistantName) {
        // è·³è½¬åˆ°åŠ©æ‰‹å¯¹è¯é¡µé¢
        window.location.href = `/assistant/${assistantId}`;
    }
    
    function selectGame(gameId) {
        // è·³è½¬åˆ°æ¸¸æˆé¡µé¢
        if (gameId === 'ai_script_host') {
            window.location.href = '/game/script-host';
        } else if (gameId === 'ai_detective_game') {
            window.location.href = '/game/detective';
        } else if (gameId === 'ai_werewolf_judge') {
            window.location.href = '/game/werewolf';
        }
    }
    
    function continueConversation(sessionId, assistantType) {
        // åŠŸèƒ½æš‚æ—¶å…³é—­
        showToast('åŠŸèƒ½å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…ï¼', 'info');
    }
    
    async function deleteConversation(sessionId, event) {
        // åŠŸèƒ½æš‚æ—¶å…³é—­
        event.stopPropagation();
        showToast('åŠŸèƒ½å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…ï¼', 'info');
    }
    
    function showAssistantModal(assistantId) {
        const assistant = assistants[assistantId];
        
        document.getElementById('modal-icon').textContent = assistant.icon;
        document.getElementById('modal-title').textContent = assistant.name;
        document.getElementById('modal-description').textContent = assistant.description;
        
        document.getElementById('start-chat-btn').onclick = () => {
            closeModal();
            selectAssistant(assistantId, assistant.name);
        };
        
        document.getElementById('assistant-modal').classList.remove('hidden');
        selectedAssistant = assistantId;
    }
    
    function closeModal() {
        document.getElementById('assistant-modal').classList.add('hidden');
        selectedAssistant = null;
    }
    
    // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', function() {
        
        // æ·»åŠ å¡ç‰‡æ‚¬åœæ•ˆæœ
        const cards = document.querySelectorAll('.card-hover');
        cards.forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-4px)';
            });
            
            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
            });
        });
    });
    
    // ç®€å•çš„æç¤ºæ¶ˆæ¯å‡½æ•°
    function showToast(message, type = 'info', duration = 3000) {
        // åˆ›å»ºæç¤ºå…ƒç´ 
        const toast = document.createElement('div');
        toast.className = `fixed top-4 right-4 px-6 py-3 rounded-lg text-white z-50 ${
            type === 'success' ? 'bg-green-500' : 
            type === 'error' ? 'bg-red-500' : 
            type === 'warning' ? 'bg-yellow-500' : 'bg-blue-500'
        }`;
        toast.textContent = message;
        
        document.body.appendChild(toast);
        
        // è‡ªåŠ¨ç§»é™¤
        setTimeout(() => {
            if (toast.parentNode) {
                toast.parentNode.removeChild(toast);
            }
        }, duration);
    }
    
    // é”®ç›˜å¿«æ·é”®
    document.addEventListener('keydown', function(e) {
        // ESCå…³é—­æ¨¡æ€æ¡†
        if (e.key === 'Escape') {
            closeModal();
        }
    });
</script>
{% endblock %}